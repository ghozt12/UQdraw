<html>
<head>
  <!-- CSS -->
  <link rel="stylesheet" href="../css/main.css">
  <link rel="stylesheet" href="../css/vendor/gridism.css">
  <!-- Sets it as a mobile viewport if the user is on a mobile device -->
  <meta name="viewport" content="width=device-width,initial-scale=1">
</head>

<body>
	<!-- Header -->
	<section>
		<div class='header-l-lecture'>
			<!-- Logo (small) -->
			<a href="#"><img class='images-l-subjects' src='../assets/images/topbar-logo.png' /></a>
			<!-- Title of the page -->
			<h3 class='type-title'> Lecture Questions </h3>
		</div>
	</section>

	<!-- Questions -->
	<section>
		<!-- The question goes here, get id question -->
		<h2 class="type-body-heading"> <span id="question-title">Draw My House</span> </h2>
		<h3 class="type-body-url"> teamone.uqcloud.net ENTER CODE: <span id = "code"> 3fg </span></h3>

		<!-- RESPONSE FILLER -->
		<!-- This works by increasing the inner divs width, so grab
		theme-response-inner and change the width accordinly -->
		<div class="timer-div">
			
			<div class="theme-timer"> </div>
			
		</div>
		<div class="theme-time2"><p>4 minutes</p> </div>
		<div class="theme-time15"><p>3 minutes</p> </div>
		<div class="theme-time1"><p>2 minutes</p> </div>
		<div class="theme-time05"><p>1 minute</p> </div>
		
		<div class="theme-response-actions">
			<!-- Enter PHP values in the spans -->
			<!--<h2> Responses <span id="responses">23</span> </h2> -->
			<h2> Time: <span id="time-left">04:00</span></h2>

			<!-- Buttons -->
			<button class="q-button-long" onclick="btnViewResponses()">View Responses</button>
			<button class="q-button" onclick="btnEnd()">End</button>
			<button class="q-button">Next</button>
		</div>
	</section>

</body>
	<!-- Library -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
	<!-- JS -->
	<script type='text/javascript'>
	$(document).ready(function() {
		$.ajax({//retrieve JSON through ajax, if the parameter(courseID) from url is wrong, noting shows
			type: 'GET',
			url: '../uqDrawBackend/getQuestion.php?courseID='+getParameterByName("courseID")+'&questionID='+getParameterByName("questionID"),
			success: function(data){
				//alert(data);
				//alert("success");
				var questionsListObject = JSON.parse(data);
				document.getElementById("code").textContent=questionsListObject.enteringCode;// 3 digit code
				//document.getElementById("subject").textContent=questionsListObject.subject;// course code
				document.getElementById("question-title").textContent=questionsListObject.questionList[0].title;

			},
			error: function(){
				console.log(data);
				alert('There was an error adding your comment');
			}
		});
	});
	function getParameterByName(name) { // get url parameter
		name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
		var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
				results = regex.exec(location.search);
		return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
	}
		function btnEnd(){
			window.location.href = "../pages/lecture-questions.html?courseID="+getParameterByName("courseID");
		}
		function btnViewResponses(){
			window.location.href = "../pages/lecture-responses.html?questionID="+getParameterByName("questionID")+"&courseID="+getParameterByName("courseID");
		}

	function startTimer(duration, display) {
    	var timer = duration, minutes, seconds;
    	setInterval(function () {
        	minutes = parseInt(timer / 60, 10);
        	seconds = parseInt(timer % 60, 10);

        	minutes = minutes < 10 ? "0" + minutes : minutes;
        	seconds = seconds < 10 ? "0" + seconds : seconds;

        	display.text(minutes + ":" + seconds);

        	if (--timer < 0) {
            	timer = 0;
            	btnEnd();
        		}
    		}, 1000);
	}

	jQuery(function ($) {
    	var twoMinutes = 60 * 4,
        display = $('#time-left');
    startTimer(twoMinutes, display);
});

</script>
</html>